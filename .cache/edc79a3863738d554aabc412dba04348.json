{"dependencies":[{"name":"./core.defaults","loc":{"line":3,"column":23}},{"name":"../helpers/index","loc":{"line":4,"column":22}},{"name":"./core.interaction","loc":{"line":5,"column":26}},{"name":"../platforms/platform","loc":{"line":6,"column":23}}],"generated":{"js":"\"use strict\";var t=require(\"./core.defaults\"),e=require(\"../helpers/index\"),i=require(\"./core.interaction\"),a=require(\"../platforms/platform\");module.exports=function(s){var n=s.plugins;s.types={},s.instances={},s.controllers={};function o(t){return\"top\"===t||\"bottom\"===t}e.extend(s.prototype,{construct:function(i,n){var o=this;n=function(i){var a=(i=i||{}).data=i.data||{};return a.datasets=a.datasets||[],a.labels=a.labels||[],i.options=e.configMerge(t.global,t[i.type],i.options||{}),i}(n);var r=a.acquireContext(i,n),l=r&&r.canvas,h=l&&l.height,c=l&&l.width;o.id=e.uid(),o.ctx=r,o.canvas=l,o.config=n,o.width=c,o.height=h,o.aspectRatio=h?c/h:null,o.options=n.options,o._bufferedRender=!1,o.chart=o,o.controller=o,s.instances[o.id]=o,Object.defineProperty(o,\"data\",{get:function(){return o.config.data},set:function(t){o.config.data=t}}),r&&l&&(o.initialize(),o.update())},initialize:function(){return n.notify(this,\"beforeInit\"),e.retinaScale(this,this.options.devicePixelRatio),this.bindEvents(),this.options.responsive&&this.resize(!0),this.ensureScalesHaveIDs(),this.buildScales(),this.initToolTip(),n.notify(this,\"afterInit\"),this},clear:function(){return e.canvas.clear(this),this},stop:function(){return s.animationService.cancelAnimation(this),this},resize:function(t){var i=this.options,a=this.canvas,s=i.maintainAspectRatio&&this.aspectRatio||null,o=Math.max(0,Math.floor(e.getMaximumWidth(a))),r=Math.max(0,Math.floor(s?o/s:e.getMaximumHeight(a)));if((this.width!==o||this.height!==r)&&(a.width=this.width=o,a.height=this.height=r,a.style.width=o+\"px\",a.style.height=r+\"px\",e.retinaScale(this,i.devicePixelRatio),!t)){var l={width:o,height:r};n.notify(this,\"resize\",[l]),this.options.onResize&&this.options.onResize(this,l),this.stop(),this.update(this.options.responsiveAnimationDuration)}},ensureScalesHaveIDs:function(){var t=this.options,i=t.scales||{},a=t.scale;e.each(i.xAxes,function(t,e){t.id=t.id||\"x-axis-\"+e}),e.each(i.yAxes,function(t,e){t.id=t.id||\"y-axis-\"+e}),a&&(a.id=a.id||\"scale\")},buildScales:function(){var t=this,i=t.options,a=t.scales={},n=[];i.scales&&(n=n.concat((i.scales.xAxes||[]).map(function(t){return{options:t,dtype:\"category\",dposition:\"bottom\"}}),(i.scales.yAxes||[]).map(function(t){return{options:t,dtype:\"linear\",dposition:\"left\"}}))),i.scale&&n.push({options:i.scale,dtype:\"radialLinear\",isDefault:!0,dposition:\"chartArea\"}),e.each(n,function(i){var n=i.options,r=e.valueOrDefault(n.type,i.dtype),l=s.scaleService.getScaleConstructor(r);if(l){o(n.position)!==o(i.dposition)&&(n.position=i.dposition);var h=new l({id:n.id,options:n,ctx:t.ctx,chart:t});a[h.id]=h,h.mergeTicksOptions(),i.isDefault&&(t.scale=h)}}),s.scaleService.addScalesToLayout(this)},buildOrUpdateControllers:function(){var t=this,i=[],a=[];return e.each(t.data.datasets,function(e,n){var o=t.getDatasetMeta(n),r=e.type||t.config.type;if(o.type&&o.type!==r&&(t.destroyDatasetMeta(n),o=t.getDatasetMeta(n)),o.type=r,i.push(o.type),o.controller)o.controller.updateIndex(n);else{var l=s.controllers[o.type];if(void 0===l)throw new Error('\"'+o.type+'\" is not a chart type.');o.controller=new l(t,n),a.push(o.controller)}},t),a},resetElements:function(){var t=this;e.each(t.data.datasets,function(e,i){t.getDatasetMeta(i).controller.reset()},t)},reset:function(){this.resetElements(),this.tooltip.initialize()},update:function(t){var i=this;if(t&&\"object\"==typeof t||(t={duration:t,lazy:arguments[1]}),function(t){var e=t.options;e.scale?t.scale.options=e.scale:e.scales&&e.scales.xAxes.concat(e.scales.yAxes).forEach(function(e){t.scales[e.id].options=e}),t.tooltip._options=e.tooltips}(i),!1!==n.notify(i,\"beforeUpdate\")){i.tooltip._data=i.data;var a=i.buildOrUpdateControllers();e.each(i.data.datasets,function(t,e){i.getDatasetMeta(e).controller.buildOrUpdateElements()},i),i.updateLayout(),e.each(a,function(t){t.reset()}),i.updateDatasets(),i.tooltip.initialize(),i.lastActive=[],n.notify(i,\"afterUpdate\"),i._bufferedRender?i._bufferedRequest={duration:t.duration,easing:t.easing,lazy:t.lazy}:i.render(t)}},updateLayout:function(){!1!==n.notify(this,\"beforeLayout\")&&(s.layoutService.update(this,this.width,this.height),n.notify(this,\"afterScaleUpdate\"),n.notify(this,\"afterLayout\"))},updateDatasets:function(){if(!1!==n.notify(this,\"beforeDatasetsUpdate\")){for(var t=0,e=this.data.datasets.length;t<e;++t)this.updateDataset(t);n.notify(this,\"afterDatasetsUpdate\")}},updateDataset:function(t){var e=this.getDatasetMeta(t),i={meta:e,index:t};!1!==n.notify(this,\"beforeDatasetUpdate\",[i])&&(e.controller.update(),n.notify(this,\"afterDatasetUpdate\",[i]))},render:function(t){var i=this;t&&\"object\"==typeof t||(t={duration:t,lazy:arguments[1]});var a=t.duration,o=t.lazy;if(!1!==n.notify(i,\"beforeRender\")){var r=i.options.animation,l=function(t){n.notify(i,\"afterRender\"),e.callback(r&&r.onComplete,[t],i)};if(r&&(void 0!==a&&0!==a||void 0===a&&0!==r.duration)){var h=new s.Animation({numSteps:(a||r.duration)/16.66,easing:t.easing||r.easing,render:function(t,i){var a=e.easing.effects[i.easing],s=i.currentStep,n=s/i.numSteps;t.draw(a(n),n,s)},onAnimationProgress:r.onProgress,onAnimationComplete:l});s.animationService.addAnimation(i,h,a,o)}else i.draw(),l(new s.Animation({numSteps:0,chart:i}));return i}},draw:function(t){var i=this;i.clear(),e.isNullOrUndef(t)&&(t=1),i.transition(t),!1!==n.notify(i,\"beforeDraw\",[t])&&(e.each(i.boxes,function(t){t.draw(i.chartArea)},i),i.scale&&i.scale.draw(),i.drawDatasets(t),i._drawTooltip(t),n.notify(i,\"afterDraw\",[t]))},transition:function(t){for(var e=0,i=(this.data.datasets||[]).length;e<i;++e)this.isDatasetVisible(e)&&this.getDatasetMeta(e).controller.transition(t);this.tooltip.transition(t)},drawDatasets:function(t){if(!1!==n.notify(this,\"beforeDatasetsDraw\",[t])){for(var e=(this.data.datasets||[]).length-1;e>=0;--e)this.isDatasetVisible(e)&&this.drawDataset(e,t);n.notify(this,\"afterDatasetsDraw\",[t])}},drawDataset:function(t,e){var i=this.getDatasetMeta(t),a={meta:i,index:t,easingValue:e};!1!==n.notify(this,\"beforeDatasetDraw\",[a])&&(i.controller.draw(e),n.notify(this,\"afterDatasetDraw\",[a]))},_drawTooltip:function(t){var e=this.tooltip,i={tooltip:e,easingValue:t};!1!==n.notify(this,\"beforeTooltipDraw\",[i])&&(e.draw(),n.notify(this,\"afterTooltipDraw\",[i]))},getElementAtEvent:function(t){return i.modes.single(this,t)},getElementsAtEvent:function(t){return i.modes.label(this,t,{intersect:!0})},getElementsAtXAxis:function(t){return i.modes[\"x-axis\"](this,t,{intersect:!0})},getElementsAtEventForMode:function(t,e,a){var s=i.modes[e];return\"function\"==typeof s?s(this,t,a):[]},getDatasetAtEvent:function(t){return i.modes.dataset(this,t,{intersect:!0})},getDatasetMeta:function(t){var e=this.data.datasets[t];e._meta||(e._meta={});var i=e._meta[this.id];return i||(i=e._meta[this.id]={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null}),i},getVisibleDatasetCount:function(){for(var t=0,e=0,i=this.data.datasets.length;e<i;++e)this.isDatasetVisible(e)&&t++;return t},isDatasetVisible:function(t){var e=this.getDatasetMeta(t);return\"boolean\"==typeof e.hidden?!e.hidden:!this.data.datasets[t].hidden},generateLegend:function(){return this.options.legendCallback(this)},destroyDatasetMeta:function(t){var e=this.id,i=this.data.datasets[t],a=i._meta&&i._meta[e];a&&(a.controller.destroy(),delete i._meta[e])},destroy:function(){var t,i,o=this.canvas;for(this.stop(),t=0,i=this.data.datasets.length;t<i;++t)this.destroyDatasetMeta(t);o&&(this.unbindEvents(),e.canvas.clear(this),a.releaseContext(this.ctx),this.canvas=null,this.ctx=null),n.notify(this,\"destroy\"),delete s.instances[this.id]},toBase64Image:function(){return this.canvas.toDataURL.apply(this.canvas,arguments)},initToolTip:function(){this.tooltip=new s.Tooltip({_chart:this,_chartInstance:this,_data:this.data,_options:this.options.tooltips},this)},bindEvents:function(){var t=this,i=t._listeners={},s=function(){t.eventHandler.apply(t,arguments)};e.each(t.options.events,function(e){a.addEventListener(t,e,s),i[e]=s}),t.options.responsive&&(s=function(){t.resize()},a.addEventListener(t,\"resize\",s),i.resize=s)},unbindEvents:function(){var t=this,i=t._listeners;i&&(delete t._listeners,e.each(i,function(e,i){a.removeEventListener(t,i,e)}))},updateHoverStyle:function(t,e,i){var a,s,n,o=i?\"setHoverStyle\":\"removeHoverStyle\";for(s=0,n=t.length;s<n;++s)(a=t[s])&&this.getDatasetMeta(a._datasetIndex).controller[o](a)},eventHandler:function(t){var e=this.tooltip;if(!1!==n.notify(this,\"beforeEvent\",[t])){this._bufferedRender=!0,this._bufferedRequest=null;var i=this.handleEvent(t);i|=e&&e.handleEvent(t),n.notify(this,\"afterEvent\",[t]);var a=this._bufferedRequest;return a?this.render(a):i&&!this.animating&&(this.stop(),this.render(this.options.hover.animationDuration,!0)),this._bufferedRender=!1,this._bufferedRequest=null,this}},handleEvent:function(t){var i=this.options||{},a=i.hover,s=!1;return this.lastActive=this.lastActive||[],\"mouseout\"===t.type?this.active=[]:this.active=this.getElementsAtEventForMode(t,a.mode,a),e.callback(i.onHover||i.hover.onHover,[t.native,this.active],this),\"mouseup\"!==t.type&&\"click\"!==t.type||i.onClick&&i.onClick.call(this,t.native,this.active),this.lastActive.length&&this.updateHoverStyle(this.lastActive,a.mode,!1),this.active.length&&a.mode&&this.updateHoverStyle(this.active,a.mode,!0),s=!e.arrayEquals(this.active,this.lastActive),this.lastActive=this.active,s}}),s.Controller=s};"},"hash":"82462f77b7c000b8efa98c44b59287bd"}